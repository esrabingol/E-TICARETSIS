BİR MAĞAZANIN GÜN BAZLI SATIŞ RAPORLARINI GETİRME
İL – TARİHE GÖRE FİLTRELEME
SELECT* FROM CUSTOMERS
WHERE CITY = 'ANKARA'
ORDER BY DATE

ŞEHİRLERE- AYLARA GÖRE SIRALAMA YAPMAK

SELECT MONTHNAME , CITY ,SUM (TOTALPRICE) AS TOTALPRICE
FROM CUSTOMERS
GROUP BY CITY,MONTHNAME
ORDER BY MONTHNAME, SOM(TOTALPROCE) DESC

KATEGORİLERE GÖRE DAĞILIMI:

SELECT CATEGORY1, CATEGORY2, CATEGORY3, CATEGORY4

SUM(TOTALPRICE) AS TOTALPRICE,
COUTN(*) AS ROWCOUNT_,
SUM(AMOUNT) AS TOTALAMOUNT

FROM CUSTOMERS
GROUP BY CATEGORY1,CATEGORY2
ORDER BY CATEGORY1,CATEGORY2

MAĞAZALARIN MÜŞTERİ SAYILARINI GETİRE
SELECT 
FISHENO,COUNT(DISTINCT FISHENO),COUNT(*)

*FROM SALES WHERE MONTHNAME  ='01.OCAK'


GROUP BY CITY
ORDER BY CITY

GRUPLADIĞIMIZ DATAYI KENDİ İÇİNDE TEKİLLEŞTİRİYORUZ
SELECT 
CITY,COUNT (DISTINCT CUSTOMERNAME) AS UNIQUECUSTOMERS,
COUNT(DISTINCT FISHENO),COUNT(*) ITEMCOUNT

*FROM SALES WHERE MONTHNAME  ='01.OCAK'

GROUP BY CITY
ORDER BY CITY


--------------------------------------------------------------------------

-- KISIYE BAGLI OLARAK FATURA LISTELEME
SADECE FATURA HAKKINDA BİLGİ VEREN SQL KODU:


SELECT 
U.USERNAME_ AS KULLANICIADI, U.NAMESURNAME AS ADSOYAD,
CT.CITY AS IL , T.TOWN AS ILCE , D.DISTRICT  AS SEMT, A.ADDRESSTEXT
AS ACIKADRES, O.ID AS SIPARISID , O.DATE_ AS TARIH,
O.TOTALPRICE AS TOPLAMTUTAR , P.DATE_ AS ODEMETARIGI, P.APPROVECODE AS BANKAOANYKODU,
I.DATE_ AS FATURATARIHI, I.CARGOFICHENO AS KARGOGISN0



FROM 

USERS U
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID

WHERE U.NAMESURNAME= 'X Y'


-- KISIYE BAGLI OLARAK FATURA LISTELEME
DETAY OLARAK ALINAN BIRIMLER


SELECT 
U.USERNAME_ AS KULLANICIADI, U.NAMESURNAME AS ADSOYAD,
CT.CITY AS IL , T.TOWN AS ILCE , D.DISTRICT  AS SEMT, A.ADDRESSTEXT
AS ACIKADRES, O.ID AS SIPARISID , O.DATE_ AS TARIH,
O.TOTALPRICE AS TOPLAMTUTAR , P.DATE_ AS ODEMETARIGI, P.APPROVECODE AS BANKAOANYKODU,
I.DATE_ AS FATURATARIHI, I.CARGOFICHENO AS KARGOGISN0,
ITM.ITEMCODE AS URUNKODU , ITM.ITMNAME AS URUNADI , OD.AMOUNT AS MIKTAR,
OD.UNITPRICE AS BIRIMFIYATI, OD.LINETOTAL AS SATIRTOPLAMI



FROM 

USERS U
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID
INNER JOIN ORDERDETAILS OD  ON OD.ORDERID= O.ID
INNER JOIN ITEMS ITM ON  ITM.ID = OD.ITEMID

WHERE 
U.ID = 1





-- ŞEHİRLERE GÖRE TOPLAM VERİLEN SİPARİŞ MİKTARLARI

SELECT 
CT.CITY AS SEHIRADI,
SUM (OD.LINETOTAL) AS  TOPLAMSIPARIS_TUTARI,
SUM (OD.AMOUNT) AS  TOPLAMSIPARIS_ADEDI,
COUNT (OD.ID) AS TOPLAMSIPARIS_SAYISI

FROM 
ORDERS O
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID
INNER JOIN ORDERDETAILS OD  ON OD.ORDERID= O.ID
INNER JOIN ITEMS ITM ON  ITM.ID = OD.ITEMID



GROUP BY CITY
ORDER BY COUNT(OD.ID) DESC
--ürün kategorilerine göre sipariş dağılımı

SELECT 
ITM.CATEGORY1,ITM.CATEGORY2,ITM.CATEGORY3,
SUM (OD.LINETOTAL) AS  TOPLAMSIPARIS_TUTARI,
SUM (OD.AMOUNT) AS  TOPLAMSIPARIS_ADEDI,
COUNT (OD.ID) AS TOPLAMSIPARIS_SAYISI


FROM 
ORDERS O
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID
INNER JOIN ORDERDETAILS OD  ON OD.ORDERID= O.ID
INNER JOIN ITEMS ITM ON  ITM.ID = OD.ITEMID


WHERE ITM.CATEGORY1 ='EV'
GROUP BY ITM.CATEGORY1
ORDER BY 1 DESC

--TARİHE GÖRE SİPARİŞ DAĞILIMINI GETİREN SORGU

SELECT  

CONVERT ( DATE , O.DATE_) TARIH,
SUM (OD.LINETOTAL) AS TOPLAMSIPARIS_TUTAR,
SUM(OD.AMOUNT) AS TOPLAMSIPARIS_MIKTAR,
COUNT (OD.ID) AS TOPLAMSIPARIS_SAYISI

FROM 
ORDERS O
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID
INNER JOIN ORDERDETAILS OD  ON OD.ORDERID= O.ID
INNER JOIN ITEMS ITM ON  ITM.ID = OD.ITEMID

GROUP BY CONVERT (DATE,O.DATE_)
ORDER BY CONVERT(DATE, O.DATE_)

-- AYLARA GÖRE SİPARİŞ DAĞILIMINI GETİREN SORGU
SELECT  
DATEPART(YEAR,O.DATE_) YIL,
DATEPART(MONTH,O.DATE_) AY,
SUM (OD.LINETOTAL) AS TOPLAMSIPARIS_TUTAR,
SUM(OD.AMOUNT) AS TOPLAMSIPARIS_MIKTAR,
COUNT (OD.ID) AS TOPLAMSIPARIS_SAYISI

FROM 
ORDERS O
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID
INNER JOIN ORDERDETAILS OD  ON OD.ORDERID= O.ID
INNER JOIN ITEMS ITM ON  ITM.ID = OD.ITEMID

GROUP BY DATEPART (YEAR, O.DATE_), DATEPART(MONTH, O.DATE_)

ORDER BY DATEPART(YEAR,O.DATE_), DATEPART ( MONTH, O.DATE_)


-- ÖDEME TÜRÜNE GÖRE DAĞILIM

SELECT 
CASE 

  WHEN PAYMENTTYPE=12 THEN 'KREDIKARTI'
  WHEN PAYMENTTYPE =242342 THEN 'BANKAHAVALESI'
 
END AS ODEMETURU_ACIKLAMA,
SUM(PAYMENTTOTAL) AS TOPLAMTUTAR
FROM PAYMENTS

GROUP BY PAYMENTTYPE

-- ORTALAMA TESLİMAT SÜRESİ

SELECT  
MIN( DATEDIFF (HOUR, O.DATE_, I.DATE_))AS ENKISA_TESLIMATSURESI_SAAT,
MAX(DATEDIFF ( HOUR, O.DATE_,I.DATE_)) AS ENKISA_TESLIMATSURESI_SAAT,
AVG( DATEDIFF (HOUR, O.DATE_, I.DATE_))AS ORTALAMA_TESLIMATSURESI_SAAT


FROM 
ORDERS O
INNER JOIN USERS U ON U.ID = O.USERID
INNER JOIN ADDRESS A ON A.ID = O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID=A.CITYID
INNER JOIN TOWN T ON T.ID =A.TOWNID
INNER JOIN DISTRICTS D ON D.ID=A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID= O.ID
INNER JOIN INVOICES I ON I.ORDERID= O.ID
INNER JOIN ORDERDETAILS OD  ON OD.ORDERID= O.ID


